# events-face Service

Сервис **events-face** - фасад для работы с мероприятиями, получаемыми от агрегатора **events-provider**.  
Основные функции: аутентификация с JWT, просмотр мероприятий, их фильтрация/сортировка/пагинация, синхронизация событий с внешним сервисом.

---

## Описание функционала

- Пользовательская аутентификация с использованием JWT (регистрация, логин, обновление токенов, выход).
- Отображение списка мероприятий с фильтрацией по названию и статусу, сортировкой по дате и пагинацией (10 на страницу).
- Модели для мероприятий и площадок (Venue, Event).
- Менеджер-команда для синхронизации мероприятий с events-provider (пока заглушка).
- Сервис подготовлен для дальнейшего расширения (асинхронная регистрация, уведомления, обработка ошибок и пр.).

---

## Локальный запуск

### 1. Клонировать репозиторий и перейти в папку проекта
```bash
git clone https://github.com/Alexion24/events-face-service.git
cd events-face-service
```

### 2. Создать виртуальное окружение и установить зависимости

Используем пакетный менеджер `uv` (предпочтительно):

```bash
uv venv .venv
source .venv/bin/activate
uv install
uv sync
```

### 3. Выполнить миграции

```bash
python manage.py migrate
```

### 4. Создать суперпользователя для доступа к админке
```bash
python manage.py createsuperuser
```

Следуйте интерактивным подсказкам для указания имени пользователя, email (необязательно) и пароля.

Пароль не отображается при вводе. После успешного создания появится сообщение: Superuser created successfully.



### 5. Запустить локальный сервер

```bash
python manage.py runserver
```

---

## Работа с API

Все API эндпоинты начинаются с `/api/`

### Аутентификация (`user_auth`)

- `POST /api/auth/register` — регистрация пользователя  
- `POST /api/auth/login` — получение пары Access и Refresh JWT токенов  
- `POST /api/auth/token/refresh` — обновление Access токена  
- `POST /api/auth/logout` — выход и аннулирование Refresh токена  

### Мероприятия (`events`)

- `GET /api/events` — список мероприятий  
  - Доступен только для авторизованных пользователей (JWT)  
  - Поддерживает:  
    - фильтрацию по названию и статусу `open`  
    - сортировку по дате проведения  
    - пагинацию (по 10 на страницу)  

### Синхронизация (`sync`)

- Менеджер-команда для синхронизации мероприятий с events-provider:

```bash
python manage.py sync_events [--date=YYYY-MM-DD] [--all]
```

*(Обратите внимание: API events-provider в настоящее время неактивно, синхронизация реализована как заглушка)*

---

## Планы по развитию

- Реализовать удаление мероприятий, завершившихся более 7 дней назад.
- Асинхронная регистрация посетителей с подтверждением результата.
- Интеграция с notification-service для отправки уведомлений.
- Обработка отказов сторонних сервисов с retry и circuit breaker.
- Реализовать потребитель Kafka топика для eventual consistency.
- Оптимизация под высокие нагрузки (кеширование, rate limiting).

---
